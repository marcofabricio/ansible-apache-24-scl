sudo: required

language: python
python: "2.7"

services:
  - docker

before_install:
  - sudo apt-get update -qq
  - sudo apt-get install sshpass

  - docker pull centos:7
  - docker run -d -p 127.0.0.1:2222:22 centos:7 /bin/sh -c "yum install -y passwd; echo -e 'password\npassword' | (passwd --stdin $USER)"
  - docker ps -a

install:
  - pip install ansible

  # add an ansible.cfg file to pick up the roles path
  - printf '[defaults]\nroles_path = ../' > ansible.cfg

script:
  - ansible-playbook -i tests/inventory tests/test.yml --syntax-check
  - ansible-playbook -i tests/inventory tests/test.yml
